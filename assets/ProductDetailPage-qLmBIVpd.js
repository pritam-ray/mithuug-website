import{c as L,h as $,r as c,R as P,s as N,j as e,i as I,k as T,d as A,l as M,L as q,B as O,a as G,b as _,g as W,H as F,m as H,n as D}from"./index-DDPWc_ZQ.js";import{S as w}from"./star-B8AD6aH5.js";import{S as E}from"./SEO-BeZmPqYZ.js";import{P as z}from"./package-BRHkGikc.js";import{T as V}from"./truck-J9eVq9qq.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=L("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Y=({product_id:i})=>{const{user:s}=$(),[o,d]=c.useState([]),[f,x]=c.useState(0),[h,j]=c.useState(0),[l,a]=c.useState(""),[b,m]=c.useState(""),[u,v]=c.useState(!1),[p,y]=c.useState(!1);P.useEffect(()=>{k()},[i]);const k=async()=>{try{const{data:t}=await N.from("reviews").select("*, user:profiles(full_name)").eq("product_id",i).order("created_at",{ascending:!1});t&&d(t)}catch(t){console.error("Error loading reviews:",t)}},C=async t=>{if(t.preventDefault(),!(!s||f===0)){y(!0);try{const{error:g}=await N.from("reviews").insert({product_id:i,user_id:s.id,rating:f,title:l,comment:b});g||(x(0),a(""),m(""),v(!1),k())}catch(g){console.error("Error submitting review:",g)}finally{y(!1)}}},S=o.length>0?o.reduce((t,g)=>t+g.rating,0)/o.length:0;return e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"border-t border-stone-200 pt-8",children:[e.jsx("h2",{className:"text-3xl font-light text-stone-900 mb-6",children:"Customer Reviews"}),e.jsx("div",{className:"bg-stone-50 rounded-lg p-6 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-4xl font-light text-stone-900",children:S.toFixed(1)}),e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(t=>e.jsx(w,{className:`w-6 h-6 ${t<=S?"fill-ochre-500 text-ochre-500":"text-stone-300"}`},t))})]}),e.jsxs("p",{className:"text-stone-600",children:[o.length," reviews"]})]}),s&&!u&&e.jsx("button",{onClick:()=>v(!0),className:"bg-ochre-500 text-white px-6 py-3 rounded-full hover:bg-ochre-600 transition-colors",children:"Write a Review"})]})}),u&&e.jsxs("form",{onSubmit:C,className:"bg-white border border-stone-200 rounded-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-xl font-light text-stone-900 mb-4",children:"Write Your Review"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Rating"}),e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>x(t),onMouseEnter:()=>j(t),onMouseLeave:()=>j(0),className:"focus:outline-none",children:e.jsx(w,{className:`w-8 h-8 transition-colors ${t<=(h||f)?"fill-ochre-500 text-ochre-500":"text-stone-300"}`})},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Review Title"}),e.jsx("input",{type:"text",value:l,onChange:t=>a(t.target.value),className:"w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-ochre-500 focus:border-transparent",placeholder:"Sum up your experience",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Your Review"}),e.jsx("textarea",{value:b,onChange:t=>m(t.target.value),rows:4,className:"w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-ochre-500 focus:border-transparent",placeholder:"Tell us what you think",required:!0})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"submit",disabled:p||f===0,className:"bg-ochre-500 text-white px-6 py-3 rounded-full hover:bg-ochre-600 transition-colors disabled:opacity-50",children:p?"Submitting...":"Submit Review"}),e.jsx("button",{type:"button",onClick:()=>{v(!1),x(0),a(""),m("")},className:"border border-stone-300 text-stone-700 px-6 py-3 rounded-full hover:bg-stone-50 transition-colors",children:"Cancel"})]})]}),e.jsx("div",{className:"space-y-6",children:o.length===0?e.jsx("p",{className:"text-center text-stone-600 py-8",children:"No reviews yet. Be the first to review!"}):o.map(t=>{var g;return e.jsxs("div",{className:"border-b border-stone-200 pb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center space-x-2 mb-1",children:[1,2,3,4,5].map(R=>e.jsx(w,{className:`w-5 h-5 ${R<=t.rating?"fill-ochre-500 text-ochre-500":"text-stone-300"}`},R))}),e.jsx("h4",{className:"font-medium text-stone-900",children:t.title})]}),e.jsx("span",{className:"text-sm text-stone-500",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-stone-700 mb-2",children:t.comment}),e.jsxs("p",{className:"text-sm text-stone-500",children:["By ",((g=t.user)==null?void 0:g.full_name)||"Anonymous"]})]},t.id)})})]})})},J=({productId:i})=>{const[s,o]=c.useState([]),[d,f]=c.useState(!0);c.useEffect(()=>{x()},[i]);const x=async()=>{try{const{data:l,error:a}=await N.rpc("get_rating_breakdown",{p_product_id:i});if(a)throw a;const b=[];for(let m=5;m>=1;m--){const u=l==null?void 0:l.find(v=>v.rating===m);b.push({rating:m,count:(u==null?void 0:u.count)||0,percentage:(u==null?void 0:u.percentage)||0})}o(b)}catch(l){console.error("Error loading rating breakdown:",l)}finally{f(!1)}},h=s.reduce((l,a)=>l+a.count,0),j=h>0?s.reduce((l,a)=>l+a.rating*a.count,0)/h:0;return d?e.jsx("div",{className:"space-y-3 animate-pulse",children:[...Array(5)].map((l,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-4 bg-chocolate-200 rounded"}),e.jsx("div",{className:"flex-1 h-4 bg-chocolate-200 rounded"}),e.jsx("div",{className:"w-12 h-4 bg-chocolate-200 rounded"})]},a))}):e.jsxs("div",{className:"bg-white rounded-xl p-6 border-2 border-ochre-100",children:[e.jsx("h3",{className:"text-xl font-playfair font-bold text-chocolate-900 mb-4",children:"Rating Breakdown"}),e.jsx("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b border-chocolate-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-ochre mb-1",children:j.toFixed(1)}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map((l,a)=>e.jsx(w,{size:16,className:a<Math.round(j)?"fill-gold text-gold":"text-chocolate-300"},a))}),e.jsxs("div",{className:"text-xs text-chocolate-600",children:[h," ",h===1?"review":"reviews"]})]})}),e.jsx("div",{className:"space-y-3",children:s.map(l=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 w-16",children:[e.jsx("span",{className:"text-sm font-semibold text-chocolate-900",children:l.rating}),e.jsx(w,{size:14,className:"fill-gold text-gold"})]}),e.jsx("div",{className:"flex-1 bg-chocolate-100 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-ochre to-gold transition-all duration-500",style:{width:`${l.percentage}%`}})}),e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm text-chocolate-600",children:l.count})})]},l.rating))}),h===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-chocolate-400 mb-2",children:e.jsx(w,{size:48,className:"mx-auto opacity-20"})}),e.jsx("p",{className:"text-chocolate-600",children:"No reviews yet"}),e.jsx("p",{className:"text-sm text-chocolate-500 mt-1",children:"Be the first to review this product!"})]})]})},U=({name:i,description:s,image:o,sku:d,price:f,currency:x="INR",availability:h="https://schema.org/InStock",rating:j=4.9,reviewCount:l=287,brand:a="MitthuuG"})=>{const b={"@context":"https://schema.org","@type":"Product",name:i,image:o,description:s,sku:d,brand:{"@type":"Brand",name:a},offers:{"@type":"Offer",url:window.location.href,priceCurrency:x,price:f.toString(),priceValidUntil:"2025-12-31",availability:h,seller:{"@type":"Organization",name:a}},aggregateRating:{"@type":"AggregateRating",ratingValue:j.toString(),reviewCount:l.toString()}};return e.jsx(I,{children:e.jsx("script",{type:"application/ld+json",children:JSON.stringify(b)})})},K=({items:i})=>{const s={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:i.map((o,d)=>({"@type":"ListItem",position:d+1,name:o.name,item:o.url}))};return e.jsx(I,{children:e.jsx("script",{type:"application/ld+json",children:JSON.stringify(s)})})},ae=()=>{var B;const{id:i}=T(),[s,o]=c.useState(null),[d,f]=c.useState([]),[x,h]=c.useState(!1),[j,l]=c.useState(!0),[a,b]=c.useState(1),[m,u]=c.useState(0),{addToCart:v}=A(),{user:p}=$();c.useEffect(()=>{i&&(y(),k(),p&&C())},[i,p]);const y=async()=>{try{const{data:r,error:n}=await N.from("products").select("*").eq("id",i).single();if(n)throw n;o(r),r&&M({id:r.id,name:r.name,price:r.price,category:"Til-Gud Bites"})}catch(r){console.error("Error loading product:",r)}finally{l(!1)}},k=async()=>{try{const{data:r,error:n}=await N.from("reviews").select(`
          *,
          user_profile:user_profiles(full_name, avatar_url)
        `).eq("product_id",i).order("created_at",{ascending:!1});if(n)throw n;f(r||[])}catch(r){console.error("Error loading reviews:",r)}},C=async()=>{if(!(!p||!i))try{const{data:r}=await N.from("wishlists").select("id").eq("user_id",p.id).eq("product_id",i).maybeSingle();h(!!r)}catch(r){console.error("Error checking wishlist:",r)}},S=async()=>{if(!(!p||!i))try{x?(await N.from("wishlists").delete().eq("user_id",p.id).eq("product_id",i),h(!1)):(await N.from("wishlists").insert([{user_id:p.id,product_id:i}]),h(!0))}catch(r){console.error("Error toggling wishlist:",r)}},t=()=>{if(s){for(let r=0;r<a;r++)v(s);D({id:s.id,name:s.name,price:s.price,quantity:a,category:"Til-Gud Bites"})}},g=d.length>0?d.reduce((r,n)=>r+n.rating,0)/d.length:0;if(j)return e.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:e.jsx("div",{className:"text-stone-600",children:"Loading..."})});if(!s)return e.jsxs("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:[e.jsx(E,{title:"Product Not Found | MitthuuG"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl text-stone-900 mb-4",children:"Product not found"}),e.jsx(q,{to:"/shop",className:"text-stone-600 hover:text-stone-900",children:"Back to shop"})]})]});const R=[{name:"Home",url:"https://pritam-ray.github.io/mithuug-website/"},{name:"Shop",url:"https://pritam-ray.github.io/mithuug-website/shop"},{name:(s==null?void 0:s.name)||"Product",url:`https://pritam-ray.github.io/mithuug-website/product/${i}`}];return e.jsxs("div",{className:"min-h-screen pt-20 bg-ivory",children:[e.jsx(E,{title:`${s.name} - Premium Til-Gud | MitthuuG`,description:s.description||`Order ${s.name} from MitthuuG. Authentic handcrafted Til-Gud sweets made with 100% natural ingredients. Price: ₹${s.price}. Free shipping on orders above ₹500.`,keywords:`${s.name}, buy ${s.name} online, til gud, traditional indian sweets`,ogImage:((B=s.images)==null?void 0:B[0])||s.image_url}),e.jsx(U,{name:s.name,description:s.description||`Handcrafted ${s.name} made with 100% natural ingredients`,image:s.images&&s.images.length>0?s.images:[s.image_url],price:s.price,currency:"INR",availability:s.stock_quantity>0?"InStock":"OutOfStock",rating:g,reviewCount:d.length,sku:s.id,brand:"MitthuuG"}),e.jsx(K,{items:R}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[e.jsx(O,{}),e.jsxs(q,{to:"/shop",className:"inline-flex items-center space-x-2 text-chocolate-600 hover:text-ochre mb-8 transition-colors font-semibold",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:"Back to Shop"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-12 mb-16",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative bg-white rounded-2xl p-4 shadow-xl",children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-xl",children:e.jsx("img",{src:s.images&&s.images.length>0?s.images[m]:s.image_url,alt:s.name,className:"w-full h-full object-cover hover:scale-110 transition-transform duration-700"})}),s.is_new&&e.jsxs("div",{className:"absolute top-8 left-8 bg-ochre text-white px-4 py-2 rounded-full text-xs font-bold tracking-widest flex items-center space-x-2 shadow-lg",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"NEW ARRIVAL"})]}),s.is_bestseller&&!s.is_new&&e.jsx("div",{className:"absolute top-8 left-8 bg-gold text-white px-4 py-2 rounded-full text-xs font-bold tracking-widest shadow-lg",children:"⭐ BESTSELLER"})]}),s.images&&s.images.length>1&&e.jsx("div",{className:"grid grid-cols-5 gap-2",children:s.images.map((r,n)=>e.jsx("button",{onClick:()=>u(n),className:`aspect-square rounded-lg overflow-hidden border-2 transition-all ${m===n?"border-ochre shadow-lg scale-105":"border-chocolate-200 hover:border-ochre-300"}`,children:e.jsx("img",{src:r,alt:`${s.name} ${n+1}`,className:"w-full h-full object-cover"})},n))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-5xl font-playfair font-bold text-chocolate mb-4 leading-tight",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((r,n)=>e.jsx(w,{className:`w-5 h-5 ${n<Math.round(g)?"fill-gold text-gold":"text-chocolate-300"}`},n))}),e.jsxs("span",{className:"text-chocolate-600 font-semibold",children:[d.length," ",d.length===1?"Review":"Reviews"]})]}),e.jsxs("div",{className:"mb-6 flex items-baseline space-x-3",children:[e.jsxs("p",{className:"text-4xl font-playfair font-bold text-ochre",children:["₹",s.price]}),e.jsxs("span",{className:"text-sm text-chocolate-500 font-semibold",children:["(",s.weight,")"]})]}),e.jsx("p",{className:"text-chocolate-700 mb-8 leading-relaxed text-lg border-l-4 border-ochre pl-4 bg-white/50 p-4 rounded-r-lg",children:s.description}),s.ingredients&&s.ingredients.length>0&&e.jsxs("div",{className:"mb-8 bg-white rounded-xl p-6 shadow-md",children:[e.jsx("h3",{className:"font-playfair font-bold text-chocolate text-xl mb-4",children:"Why You'll Love This"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx(_,{className:"w-5 h-5 text-olive flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-chocolate-700",children:"100% Natural Ingredients - No Preservatives"})]}),e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx(_,{className:"w-5 h-5 text-olive flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-chocolate-700",children:"Handcrafted in Small Batches"})]}),e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx(_,{className:"w-5 h-5 text-olive flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-chocolate-700",children:"Traditional Recipe with Modern Quality Standards"})]})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md",children:[e.jsxs("h3",{className:"font-playfair font-bold text-chocolate text-lg mb-3 flex items-center space-x-2",children:[e.jsx(_,{className:"w-5 h-5 text-olive"}),e.jsx("span",{children:"Pure Ingredients"})]}),e.jsx("p",{className:"text-chocolate-700 leading-relaxed",children:s.ingredients.join(", ")})]}),e.jsxs("div",{className:"flex items-center justify-between py-4 px-6 bg-white rounded-xl shadow-md",children:[e.jsx("span",{className:"text-chocolate-600 font-semibold",children:"Stock Status"}),e.jsx("span",{className:`font-bold ${s.stock_quantity>0?"text-olive":"text-red-600"}`,children:s.stock_quantity>0?`In Stock (${s.stock_quantity} available)`:"Out of Stock"})]})]}),e.jsx("div",{className:"flex items-center space-x-4 mb-8",children:e.jsxs("div",{className:"flex items-center border-2 border-ochre rounded-full bg-white shadow-md",children:[e.jsx("button",{onClick:()=>b(Math.max(1,a-1)),className:"px-5 py-3 hover:bg-ochre-50 transition-colors font-bold text-chocolate text-lg",children:"−"}),e.jsx("span",{className:"px-8 py-3 border-x-2 border-ochre font-bold text-chocolate text-lg",children:a}),e.jsx("button",{onClick:()=>b(Math.min(s.stock_quantity,a+1)),className:"px-5 py-3 hover:bg-ochre-50 transition-colors font-bold text-chocolate text-lg",disabled:a>=s.stock_quantity,children:"+"})]})}),e.jsxs("div",{className:"flex space-x-4 mb-8",children:[e.jsxs("button",{onClick:t,disabled:s.stock_quantity===0,className:"flex-1 bg-ochre text-white py-4 px-6 rounded-full hover:bg-ochre-600 transition-all duration-300 flex items-center justify-center space-x-3 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed font-bold text-lg",children:[e.jsx(W,{className:"w-6 h-6"}),e.jsx("span",{className:"tracking-wide",children:"ADD TO CART"})]}),p&&e.jsx("button",{onClick:S,className:`px-6 py-4 rounded-full border-2 transition-all duration-300 shadow-md ${x?"border-red-500 bg-red-50 text-red-500":"border-ochre-300 bg-white text-chocolate hover:border-ochre"}`,children:e.jsx(F,{className:`w-6 h-6 ${x?"fill-current":""}`})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-8 border-t-2 border-ochre-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-ochre-50 rounded-full p-4 inline-block mb-2",children:e.jsx(z,{className:"w-8 h-8 mx-auto text-ochre"})}),e.jsx("p",{className:"text-xs font-semibold text-chocolate-600",children:"Premium Packaging"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-ochre-50 rounded-full p-4 inline-block mb-2",children:e.jsx(V,{className:"w-8 h-8 mx-auto text-ochre"})}),e.jsx("p",{className:"text-xs font-semibold text-chocolate-600",children:"Free Shipping"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-ochre-50 rounded-full p-4 inline-block mb-2",children:e.jsx(H,{className:"w-8 h-8 mx-auto text-ochre"})}),e.jsx("p",{className:"text-xs font-semibold text-chocolate-600",children:"Quality Assured"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Y,{product_id:s.id})}),e.jsx("div",{children:e.jsx(J,{productId:s.id})})]})]})]})};export{ae as default};
