import{s as I,q as pe,d as xe,h as ge,r as p,w as fe,j as e,A as be,C as ye}from"./index-DDPWc_ZQ.js";import{S as V}from"./SEO-BeZmPqYZ.js";import{C as ve}from"./credit-card-wXooDei1.js";import{L as se}from"./lock-DiOKqcWd.js";import{T as ae}from"./truck-J9eVq9qq.js";import{T as je}from"./tag-Bv95X67e.js";const Ne={BASE_URL:"/mithuug-website/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_NAME:"MitthuuG",VITE_APP_URL:"https://pritam-ray.github.io/mithuug-website",VITE_GA4_MEASUREMENT_ID:"",VITE_META_PIXEL_ID:"",VITE_PAYMENT_MODE:"test",VITE_RAZORPAY_KEY_ID:"rzp_test_RW2mMIwwHqmKC8",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZveXJhdG10eHFrZm50anVubWJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3ODEyNjIsImV4cCI6MjA3NzM1NzI2Mn0._6nEe4PwNpi8FJui-zwb_RrFR9tZ9Q9Q_6qjv8-ormQ",VITE_SUPABASE_URL:"https://voyratmtxqkfntjunmbr.supabase.co",VITE_SUPPORT_EMAIL:"support@mitthuug.com"},_e=()=>{const a=["VITE_SUPABASE_URL","VITE_SUPABASE_ANON_KEY","VITE_RAZORPAY_KEY_ID"].filter(i=>!Ne[i]);a.length>0&&console.warn(`⚠️  Missing environment variables: ${a.join(", ")}
Please create a .env file based on .env.example`)},we=()=>(_e(),{supabase:{url:"https://voyratmtxqkfntjunmbr.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZveXJhdG10eHFrZm50anVubWJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3ODEyNjIsImV4cCI6MjA3NzM1NzI2Mn0._6nEe4PwNpi8FJui-zwb_RrFR9tZ9Q9Q_6qjv8-ormQ"},razorpay:{keyId:"rzp_test_RW2mMIwwHqmKC8",isTestMode:!0},analytics:{ga4MeasurementId:"",metaPixelId:""},app:{name:"MitthuuG",url:"https://pritam-ray.github.io/mithuug-website",supportEmail:"support@mitthuug.com",supportPhone:void 0},upi:void 0}),Ce=we(),y={minAmount:99,maxAmount:1e4,fee:2,allowedPincodes:[]},Se=r=>r<y.minAmount||r>y.maxAmount?0:Math.round(r*y.fee/100),re=(r,a)=>r<y.minAmount||r>y.maxAmount?!1:y.allowedPincodes.length>0&&a?y.allowedPincodes.includes(a):!0,De=()=>new Promise(r=>{const a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.async=!0,a.onload=()=>{r(!0)},a.onerror=()=>{r(!1)},document.body.appendChild(a)}),Ie=async(r,a,i)=>{if(!await De()){i(new Error("Failed to load Razorpay SDK"));return}const n=Ce.razorpay.keyId,s=new window.Razorpay({key:n,...r,handler:c=>{a(c)},modal:{ondismiss:()=>{i(new Error("Payment cancelled by user"))}}});s.on("payment.failed",c=>{i(c.error)}),s.open()},Pe=async(r,a,i)=>{try{const{data:o,error:n}=await I.functions.invoke("create-razorpay-order",{body:{amount:r,currency:"INR",receipt:a||`order_${Date.now()}`,notes:i||{}}});if(n)throw console.error("Supabase function error:",n),new Error("Failed to create order");if(!o.success||!o.order)throw new Error(o.error||"Failed to create order");return{orderId:o.order.id,amount:o.order.amount/100,currency:o.order.currency}}catch(o){throw console.error("Error creating Razorpay order:",o),o}},Ee=async(r,a,i)=>{try{const{data:o,error:n}=await I.functions.invoke("verify-razorpay-payment",{body:{razorpay_order_id:r,razorpay_payment_id:a,razorpay_signature:i}});return n?(console.error("Supabase function error:",n),!1):o.success&&o.isValid}catch(o){return console.error("Error verifying payment:",o),!1}},P=[{id:"metro",name:"Metro Cities",states:["Delhi","Maharashtra","Karnataka","Tamil Nadu","Telangana"],deliveryDays:{min:2,max:4},shippingFee:0,freeShippingThreshold:0},{id:"tier1",name:"Tier 1 Cities",states:["Gujarat","West Bengal","Rajasthan","Punjab","Haryana","Kerala","Uttar Pradesh"],deliveryDays:{min:3,max:5},shippingFee:50,freeShippingThreshold:499},{id:"tier2",name:"Tier 2/3 Cities",states:["Madhya Pradesh","Chhattisgarh","Odisha","Jharkhand","Bihar","Assam","Uttarakhand","Himachal Pradesh","Goa"],deliveryDays:{min:4,max:7},shippingFee:75,freeShippingThreshold:499},{id:"remote",name:"Remote Areas",states:["Jammu and Kashmir","Ladakh","Arunachal Pradesh","Nagaland","Manipur","Mizoram","Tripura","Meghalaya","Sikkim","Andaman and Nicobar Islands","Lakshadweep"],deliveryDays:{min:7,max:10},shippingFee:100,freeShippingThreshold:999}],ke={110:"Delhi",400:"Maharashtra",411:"Maharashtra",560:"Karnataka",600:"Tamil Nadu",500:"Telangana",380:"Gujarat",700:"West Bengal"},ne=r=>{if(!r||r.length<3)return null;const a=r.substring(0,3);return ke[a]||null},oe=r=>P.find(i=>i.states.some(o=>o.toLowerCase()===r.toLowerCase()))||P[P.length-1],E=r=>/^[1-9][0-9]{5}$/.test(r),ie=(r,a)=>{if(!E(r))return 0;const i=ne(r);if(!i)return P[0].shippingFee;const o=oe(i);return o.freeShippingThreshold!==void 0&&a>=o.freeShippingThreshold?0:o.shippingFee},Ae=(r,a)=>{if(!E(r))return null;const i=ne(r),o=i?oe(i):P[0],n=ie(r,a),s=o.freeShippingThreshold!==void 0&&a>=o.freeShippingThreshold,c=new Date,x=new Date(c);x.setDate(c.getDate()+o.deliveryDays.min);const d=new Date(c);return d.setDate(c.getDate()+o.deliveryDays.max),{zone:o.name,deliveryDays:`${o.deliveryDays.min}-${o.deliveryDays.max} days`,shippingFee:n,freeShippingEligible:s,estimatedDate:{min:x,max:d}}},Oe=r=>{const a={month:"short",day:"numeric"},i=r.estimatedDate.min.toLocaleDateString("en-IN",a),o=r.estimatedDate.max.toLocaleDateString("en-IN",a);return`${i} - ${o}`},le=[{code:"WELCOME10",description:"Get 10% off on your first order",type:"percentage",value:10,minOrderValue:299,maxDiscount:150,validFrom:new Date("2024-01-01"),validUntil:new Date("2025-12-31"),usedCount:0,firstOrderOnly:!0,enabled:!0},{code:"TILGUD50",description:"Flat ₹50 off on orders above ₹499",type:"fixed",value:50,minOrderValue:499,validFrom:new Date("2024-01-01"),validUntil:new Date("2025-12-31"),usedCount:0,enabled:!0},{code:"FREESHIP",description:"Free shipping on all orders",type:"freeShipping",value:0,minOrderValue:0,validFrom:new Date("2024-01-01"),validUntil:new Date("2025-12-31"),usedCount:0,enabled:!0},{code:"FESTIVE15",description:"Festive Special: 15% off",type:"percentage",value:15,minOrderValue:599,maxDiscount:200,validFrom:new Date("2024-01-01"),validUntil:new Date("2025-01-31"),usageLimit:100,usedCount:0,enabled:!0},{code:"BULK20",description:"20% off on orders above ₹999",type:"percentage",value:20,minOrderValue:999,maxDiscount:300,validFrom:new Date("2024-01-01"),validUntil:new Date("2025-12-31"),usedCount:0,enabled:!0}],ze=(r,a,i=!1,o=[])=>{const n=le.find(x=>x.code.toUpperCase()===r.toUpperCase());if(!n)return{valid:!1,message:"Invalid promo code"};if(!n.enabled)return{valid:!1,message:"This promo code is no longer active"};const s=new Date;if(s<n.validFrom||s>n.validUntil)return{valid:!1,message:"This promo code has expired"};if(n.usageLimit&&n.usedCount>=n.usageLimit)return{valid:!1,message:"This promo code has reached its usage limit"};if(n.firstOrderOnly&&!i)return{valid:!1,message:"This promo code is only valid for first-time customers"};if(n.minOrderValue&&a<n.minOrderValue)return{valid:!1,message:`Minimum order value of ₹${n.minOrderValue} required`};if(n.applicableProducts&&n.applicableProducts.length>0&&!o.some(d=>{var S;return(S=n.applicableProducts)==null?void 0:S.includes(d)}))return{valid:!1,message:"This promo code is not applicable to items in your cart"};if(n.type==="freeShipping")return{valid:!0,message:"Free shipping applied!",discount:0,freeShipping:!0,promoCode:n};let c=0;return n.type==="percentage"?(c=Math.round(a*n.value/100),n.maxDiscount&&(c=Math.min(c,n.maxDiscount))):n.type==="fixed"&&(c=n.value),{valid:!0,message:`Promo code applied! You saved ₹${c}`,discount:c,freeShipping:!1,promoCode:n}},Te=(r,a,i,o)=>ze(r,a,i,o),Me=()=>{const r=new Date;return le.filter(a=>a.enabled&&r>=a.validFrom&&r<=a.validUntil&&(!a.usageLimit||a.usedCount<a.usageLimit))},Ge=()=>{var G,$,Z,B,K,Y,H,Q,X,W;const r=pe(),{cart:a,cartTotal:i,clearCart:o}=xe(),{user:n,profile:s}=ge(),[c,x]=p.useState(!1),[d,S]=p.useState("razorpay"),[O,q]=p.useState(0),[u,L]=p.useState(null),[z,T]=p.useState(""),[m,M]=p.useState(null),[U,D]=p.useState(""),[F,ce]=p.useState(!1),[l,f]=p.useState({name:(s==null?void 0:s.full_name)||"",line1:((G=s==null?void 0:s.default_shipping_address)==null?void 0:G.line1)||"",line2:(($=s==null?void 0:s.default_shipping_address)==null?void 0:$.line2)||"",city:((Z=s==null?void 0:s.default_shipping_address)==null?void 0:Z.city)||"",state:((B=s==null?void 0:s.default_shipping_address)==null?void 0:B.state)||"",postal_code:((K=s==null?void 0:s.default_shipping_address)==null?void 0:K.postal_code)||"",country:"India",phone:(s==null?void 0:s.phone)||""}),[h,v]=p.useState({name:(s==null?void 0:s.full_name)||"",line1:((Y=s==null?void 0:s.default_billing_address)==null?void 0:Y.line1)||"",line2:((H=s==null?void 0:s.default_billing_address)==null?void 0:H.line2)||"",city:((Q=s==null?void 0:s.default_billing_address)==null?void 0:Q.city)||"",state:((X=s==null?void 0:s.default_billing_address)==null?void 0:X.state)||"",postal_code:((W=s==null?void 0:s.default_billing_address)==null?void 0:W.postal_code)||"",country:"India",phone:(s==null?void 0:s.phone)||""}),[R,de]=p.useState(!0);p.useEffect(()=>{const t=l.postal_code;if(t&&E(t)){const _=ie(t,i),g=Ae(t,i);q(_),L(g)}else t&&(q(0),L(null))},[l.postal_code,i]),p.useEffect(()=>{a.length>0&&fe(a.map(t=>({item_id:t.id,item_name:t.name,price:t.price,quantity:t.quantity})),i)},[]);const J=()=>{if(!z.trim()){D("Please enter a promo code");return}const t=Te(z.trim(),i,!0,a.map(_=>_.id));t.valid?(M(t),D("")):(D(t.message),M(null))},ue=()=>{M(null),T(""),D("")},k=(m==null?void 0:m.discount)||0,j=d==="cod"?Se(i):0,N=m!=null&&m.freeShipping?0:O,A=i-k+N+j,me=async t=>{var _;if(t.preventDefault(),!(!n||a.length===0)){if(!l.postal_code||!E(l.postal_code)){alert("Please enter a valid Indian pincode");return}if(d==="cod"&&!re(i,l.postal_code)){alert("COD is not available for this order. Min: ₹99, Max: ₹10,000");return}x(!0);try{const g=`MG-${Date.now()}`,{data:w,error:ee}=await I.from("orders").insert([{user_id:n.id,order_number:g,status:d==="cod"?"pending":"payment_pending",total_amount:A,subtotal_amount:i,shipping_address:l,billing_address:R?l:h,payment_method:d,payment_status:"pending",promo_code:((_=m==null?void 0:m.promoCode)==null?void 0:_.code)||null,discount_amount:k,shipping_fee:N,cod_fee:j,shipping_zone:(u==null?void 0:u.zone)||null,estimated_delivery_start:(u==null?void 0:u.startDate)||null,estimated_delivery_end:(u==null?void 0:u.endDate)||null}]).select().single();if(ee)throw ee;const he=a.map(b=>({order_id:w.id,product_id:b.id,quantity:b.quantity,price_at_time:b.price})),{error:te}=await I.from("order_items").insert(he);if(te)throw te;if(d==="razorpay"){const b=await Pe(A,g,{order_id:w.id,customer_email:n.email||"",customer_phone:l.phone});await Ie({amount:b.amount*100,currency:b.currency,name:"MitthuuG",description:`Order #${g}`,order_id:b.orderId,prefill:{name:l.name,email:n.email||"",contact:l.phone},notes:{order_id:w.id,order_number:g},theme:{color:"#C6862E"}},async C=>{await Ee(C.razorpay_order_id,C.razorpay_payment_id,C.razorpay_signature)?(await I.from("orders").update({status:"confirmed",payment_status:"completed",payment_id:C.razorpay_payment_id}).eq("id",w.id),o(),r(`/account/orders/${w.id}`)):(console.error("Payment signature verification failed"),alert("Payment verification failed. Please contact support."),x(!1))},C=>{console.error("Payment failed:",C),alert("Payment failed. Please try again."),x(!1)})}else o(),r(`/account/orders/${w.id}`)}catch(g){console.error("Error creating order:",g),alert("Failed to create order. Please try again."),x(!1)}}};return n?a.length===0?e.jsxs("div",{className:"min-h-screen pt-20 flex items-center justify-center bg-ivory",children:[e.jsx(V,{title:"Checkout | MitthuuG"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-playfair text-chocolate mb-4",children:"Your cart is empty"}),e.jsx("button",{onClick:()=>r("/shop"),className:"px-8 py-3 bg-ochre text-white rounded-full hover:bg-ochre-600 transition-colors font-semibold",children:"Continue Shopping"})]})]}):e.jsxs("div",{className:"min-h-screen pt-20 bg-ivory",children:[e.jsx(V,{title:"Secure Checkout | MitthuuG",description:"Complete your order securely. Fast shipping, multiple payment options, and guaranteed freshness on all Til-Gud sweets.",keywords:"checkout, buy til gud, order sweets, secure payment"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[e.jsx("h1",{className:"text-4xl font-light tracking-tight text-stone-900 mb-12",children:"Checkout"}),e.jsxs("form",{onSubmit:me,className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-light text-stone-900 mb-6",children:"Shipping Address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",required:!0,value:l.name,onChange:t=>f({...l,name:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Address Line 1"}),e.jsx("input",{type:"text",required:!0,value:l.line1,onChange:t=>f({...l,line1:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Address Line 2 (Optional)"}),e.jsx("input",{type:"text",value:l.line2,onChange:t=>f({...l,line2:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"City"}),e.jsx("input",{type:"text",required:!0,value:l.city,onChange:t=>f({...l,city:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"State"}),e.jsx("input",{type:"text",required:!0,value:l.state,onChange:t=>f({...l,state:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Postal Code"}),e.jsx("input",{type:"text",required:!0,value:l.postal_code,onChange:t=>f({...l,postal_code:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",required:!0,value:l.phone,onChange:t=>f({...l,phone:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-light text-stone-900",children:"Billing Address"}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:t=>de(t.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-stone-600",children:"Same as shipping"})]})]}),!R&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",required:!0,value:h.name,onChange:t=>v({...h,name:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Address Line 1"}),e.jsx("input",{type:"text",required:!0,value:h.line1,onChange:t=>v({...h,line1:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"City"}),e.jsx("input",{type:"text",required:!0,value:h.city,onChange:t=>v({...h,city:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"State"}),e.jsx("input",{type:"text",required:!0,value:h.state,onChange:t=>v({...h,state:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Postal Code"}),e.jsx("input",{type:"text",required:!0,value:h.postal_code,onChange:t=>v({...h,postal_code:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-stone-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",required:!0,value:h.phone,onChange:t=>v({...h,phone:t.target.value}),className:"w-full px-4 py-3 border border-stone-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-400"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-sm border-2 border-ochre-100",children:[e.jsxs("h2",{className:"text-2xl font-playfair font-bold text-chocolate mb-6 flex items-center",children:[e.jsx(ve,{className:"w-6 h-6 mr-3 text-ochre"}),"Payment Method"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:`flex items-start p-4 border-2 rounded-lg cursor-pointer transition-all ${d==="razorpay"?"border-ochre bg-ochre-50 shadow-md":"border-ochre-200 hover:border-ochre-300"}`,children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:d==="razorpay",onChange:t=>S(t.target.value),className:"mt-1 accent-ochre"}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-chocolate",children:"Online Payment"}),e.jsx("img",{src:"https://razorpay.com/assets/razorpay-glyph.svg",alt:"Razorpay",className:"h-6"})]}),e.jsx("p",{className:"text-sm text-chocolate-600 mt-1",children:"Credit/Debit Card, UPI, NetBanking, Wallets"}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(se,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-semibold",children:"100% Secure Payment"})]})]})]}),e.jsxs("label",{className:`flex items-start p-4 border-2 rounded-lg cursor-pointer transition-all ${d==="cod"?"border-ochre bg-ochre-50 shadow-md":"border-ochre-200 hover:border-ochre-300"}`,children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"cod",checked:d==="cod",onChange:t=>S(t.target.value),className:"mt-1 accent-ochre"}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-chocolate",children:"Cash on Delivery"}),e.jsx(ae,{className:"w-5 h-5 text-ochre"})]}),e.jsx("p",{className:"text-sm text-chocolate-600 mt-1",children:"Pay when you receive the order"}),j>0&&e.jsx("div",{className:"mt-2 p-2 bg-amber-50 border border-amber-200 rounded",children:e.jsxs("p",{className:"text-xs text-amber-800",children:["COD fee: ₹",j," (2% of order value)"]})}),!re(i,l.postal_code||"")&&e.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded",children:e.jsx("p",{className:"text-xs text-red-700",children:"COD available only for orders between ₹99 and ₹10,000"})})]})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg border-2 border-ochre-100 sticky top-24",children:[e.jsx("h2",{className:"text-2xl font-playfair font-bold text-chocolate mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6 max-h-64 overflow-y-auto",children:a.map(t=>e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("img",{src:t.image_url,alt:t.name,className:"w-16 h-16 object-cover rounded-lg border-2 border-ochre-100"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-chocolate",children:t.name}),e.jsxs("p",{className:"text-xs text-chocolate-600",children:["Qty: ",t.quantity]})]}),e.jsxs("p",{className:"text-sm font-bold text-ochre",children:["₹",t.price*t.quantity]})]},t.id))}),u&&e.jsx("div",{className:"mb-6 p-4 bg-olive-50 border-2 border-olive-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ae,{className:"w-5 h-5 text-olive mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-olive-800",children:"Estimated Delivery"}),e.jsxs("p",{className:"text-xs text-olive-700",children:[Oe(u)," (",u.deliveryDays,")"]}),e.jsx("p",{className:"text-xs text-olive-600 mt-1",children:u.zone})]})]})}),e.jsx("div",{className:"mb-6",children:m?e.jsx("div",{className:"p-4 bg-green-50 border-2 border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-green-800",children:[m.promoCode.code," Applied!"]}),e.jsx("p",{className:"text-xs text-green-700",children:m.message})]})]}),e.jsx("button",{type:"button",onClick:ue,className:"text-red-600 hover:text-red-800 text-xs font-semibold",children:"Remove"})]})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(je,{className:"w-4 h-4 text-ochre"}),e.jsx("label",{className:"text-sm font-semibold text-chocolate",children:"Have a promo code?"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:z,onChange:t=>{T(t.target.value.toUpperCase()),D("")},placeholder:"Enter code",className:"flex-1 px-4 py-2 border-2 border-ochre-200 rounded-lg focus:border-ochre focus:ring-2 focus:ring-ochre-200 transition-all uppercase"}),e.jsx("button",{type:"button",onClick:J,className:"px-6 py-2 bg-ochre text-white rounded-lg hover:bg-ochre-600 transition-colors font-semibold",children:"Apply"})]}),U&&e.jsxs("p",{className:"text-xs text-red-600 mt-1 flex items-center space-x-1",children:[e.jsx(be,{className:"w-3 h-3"}),e.jsx("span",{children:U})]}),e.jsxs("button",{type:"button",onClick:()=>ce(!F),className:"text-xs text-ochre hover:underline mt-2",children:[F?"Hide":"View"," available codes"]}),F&&e.jsx("div",{className:"mt-2 space-y-2",children:Me().map(t=>e.jsxs("button",{type:"button",onClick:()=>{T(t.code),J()},className:"w-full text-left p-2 bg-ochre-50 rounded-lg hover:bg-ochre-100 transition-colors",children:[e.jsx("p",{className:"text-xs font-bold text-ochre",children:t.code}),e.jsx("p",{className:"text-xs text-chocolate-600",children:t.description})]},t.code))})]})}),e.jsxs("div",{className:"border-t-2 border-ochre-100 pt-4 space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-chocolate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["₹",i]})]}),k>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsxs("span",{children:["Discount (",m.promoCode.code,")"]}),e.jsxs("span",{className:"font-semibold",children:["-₹",k]})]}),e.jsxs("div",{className:"flex justify-between text-chocolate-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Shipping"}),N===0&&O>0&&e.jsx("span",{className:"text-xs text-green-600",children:"(Free!)"})]}),e.jsx("span",{className:`font-semibold ${N===0?"text-green-600 line-through":""}`,children:N===0?`₹${O}`:`₹${N}`})]}),j>0&&e.jsxs("div",{className:"flex justify-between text-chocolate-600",children:[e.jsx("span",{children:"COD Fee (2%)"}),e.jsxs("span",{className:"font-semibold",children:["₹",j]})]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold text-chocolate pt-3 border-t-2 border-ochre-200",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{className:"text-ochre",children:["₹",A]})]})]}),e.jsx("button",{type:"submit",disabled:c||!!l.postal_code&&!E(l.postal_code),className:"w-full bg-gradient-mitthuug text-white py-4 rounded-full hover:shadow-mitthuug-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed tracking-wide font-bold text-lg shadow-mitthuug",children:c?"Processing...":d==="cod"?"PLACE ORDER (COD)":`PAY ₹${A}`}),e.jsxs("p",{className:"text-xs text-chocolate-500 text-center mt-4",children:[e.jsx(se,{className:"w-3 h-3 inline mr-1"}),"Secure checkout · 100% safe"]})]})})]})]})]}):e.jsxs("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:[e.jsx(V,{title:"Checkout - Sign In Required | MitthuuG"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl text-stone-900 mb-4",children:"Please sign in to checkout"}),e.jsx("button",{onClick:()=>r("/login"),className:"px-8 py-3 bg-stone-900 text-white rounded-full hover:bg-stone-800 transition-colors",children:"Sign In"})]})]})};export{Ge as default};
