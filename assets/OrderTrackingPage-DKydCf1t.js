import{k as P,q as E,h as L,r as n,s as j,j as e,x as z,A as N,L as g,o as A,C as $}from"./index-DDPWc_ZQ.js";import{S as q}from"./SEO-BeZmPqYZ.js";import{A as F}from"./arrow-left-BOFrSrdS.js";import{C as M}from"./calendar-C5LQugoM.js";import{P as v}from"./package-BRHkGikc.js";import{C as H}from"./clock-YrbTxOYU.js";import{T as y}from"./truck-J9eVq9qq.js";const U=()=>{const{orderId:c}=P(),_=E(),{user:o}=L(),[s,w]=n.useState(null),[C,k]=n.useState([]),[S,u]=n.useState(!0),[b,m]=n.useState(null);n.useEffect(()=>{o&&c?O():o||_("/login")},[o,c]);const O=async()=>{try{u(!0),m(null);const{data:t,error:r}=await j.from("orders").select("*").eq("id",c).single();if(r)throw r;if(t.user_id!==(o==null?void 0:o.id)){m("Order not found");return}w(t);const{data:a,error:d}=await j.from("order_status_history").select("*").eq("order_id",c).order("created_at",{ascending:!1});if(d)throw d;k(a||[])}catch(t){console.error("Error loading order tracking:",t),m("Failed to load order tracking information")}finally{u(!1)}},f=t=>{const r={pending:{label:"Order Placed",icon:v,color:"text-blue-600",bgColor:"bg-blue-50"},processing:{label:"Processing",icon:H,color:"text-yellow-600",bgColor:"bg-yellow-50"},shipped:{label:"Shipped",icon:y,color:"text-purple-600",bgColor:"bg-purple-50"},in_transit:{label:"In Transit",icon:y,color:"text-indigo-600",bgColor:"bg-indigo-50"},out_for_delivery:{label:"Out for Delivery",icon:A,color:"text-orange-600",bgColor:"bg-orange-50"},delivered:{label:"Delivered",icon:$,color:"text-green-600",bgColor:"bg-green-50"},failed:{label:"Delivery Failed",icon:N,color:"text-red-600",bgColor:"bg-red-50"},returned:{label:"Returned",icon:v,color:"text-gray-600",bgColor:"bg-gray-50"}};return r[t]||r.pending},h=t=>["pending","processing","shipped","in_transit","out_for_delivery","delivered"].indexOf(t)+1;if(S)return e.jsx("div",{className:"min-h-screen pt-20 bg-ivory flex items-center justify-center",children:e.jsx(z,{size:48,className:"animate-spin text-ochre"})});if(b||!s)return e.jsx("div",{className:"min-h-screen pt-20 bg-ivory",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-16 text-center",children:[e.jsx(N,{size:64,className:"mx-auto text-red-500 mb-4"}),e.jsx("h1",{className:"text-3xl font-playfair font-bold text-chocolate-900 mb-4",children:b||"Order Not Found"}),e.jsx(g,{to:"/account/orders",className:"inline-block bg-ochre text-white px-8 py-3 rounded-lg hover:bg-ochre-600 transition-colors",children:"View All Orders"})]})});const l=f(s.shipping_status),D=l.icon,I=h(s.shipping_status);return e.jsxs("div",{className:"min-h-screen pt-20 bg-ivory",children:[e.jsx(q,{title:`Track Order ${s.order_number} - MitthuuG`,description:"Track your order status and delivery"}),e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-12",children:[e.jsxs(g,{to:"/account/orders",className:"inline-flex items-center gap-2 text-chocolate-600 hover:text-ochre mb-8 transition-colors",children:[e.jsx(F,{size:20}),"Back to Orders"]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-playfair font-bold text-chocolate-900 mb-2",children:["Order ",s.order_number]}),e.jsxs("p",{className:"text-chocolate-600",children:["Placed on ",new Date(s.created_at).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"})]})]}),e.jsxs("div",{className:`flex items-center gap-3 px-6 py-3 rounded-full ${l.bgColor}`,children:[e.jsx(D,{size:24,className:l.color}),e.jsx("span",{className:`font-semibold ${l.color}`,children:l.label})]})]}),s.tracking_number&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-ivory rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-chocolate-600 mb-1",children:"Tracking Number"}),e.jsx("p",{className:"font-semibold text-chocolate-900",children:s.tracking_number})]}),s.shipping_carrier&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-chocolate-600 mb-1",children:"Carrier"}),e.jsx("p",{className:"font-semibold text-chocolate-900",children:s.shipping_carrier})]}),s.estimated_delivery_date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-chocolate-600 mb-1",children:"Estimated Delivery"}),e.jsx("p",{className:"font-semibold text-chocolate-900",children:new Date(s.estimated_delivery_date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8 mb-8",children:[e.jsx("h2",{className:"text-2xl font-playfair font-bold text-chocolate-900 mb-8",children:"Tracking Timeline"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-chocolate-200"}),e.jsx("div",{className:"absolute left-8 top-0 w-0.5 bg-ochre transition-all duration-500",style:{height:`${I/6*100}%`}}),e.jsx("div",{className:"space-y-8",children:["pending","processing","shipped","in_transit","out_for_delivery","delivered"].map((t,r)=>{const a=f(t),d=a.icon,x=h(s.shipping_status)>r,p=h(s.shipping_status)===r+1,i=C.find(T=>T.shipping_status===t);return e.jsxs("div",{className:"relative flex items-start gap-6",children:[e.jsx("div",{className:`relative z-10 flex items-center justify-center w-16 h-16 rounded-full ${p?a.bgColor:x?"bg-green-50":"bg-gray-100"}`,children:e.jsx(d,{size:28,className:p?a.color:x?"text-green-600":"text-gray-400"})}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h3",{className:`text-lg font-semibold mb-1 ${p||x?"text-chocolate-900":"text-chocolate-400"}`,children:a.label}),i&&e.jsxs("p",{className:"text-sm text-chocolate-600 mb-2",children:[e.jsx(M,{size:14,className:"inline mr-1"}),new Date(i.created_at).toLocaleString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]}),(i==null?void 0:i.notes)&&e.jsx("p",{className:"text-sm text-chocolate-600",children:i.notes})]})]},t)})})]})]}),s.shipping_address&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8",children:[e.jsx("h2",{className:"text-2xl font-playfair font-bold text-chocolate-900 mb-4",children:"Delivery Address"}),e.jsxs("div",{className:"text-chocolate-600",children:[e.jsx("p",{className:"font-semibold text-chocolate-900",children:s.shipping_address.name}),e.jsx("p",{children:s.shipping_address.line1}),s.shipping_address.line2&&e.jsx("p",{children:s.shipping_address.line2}),e.jsxs("p",{children:[s.shipping_address.city,", ",s.shipping_address.state," ",s.shipping_address.postal_code]}),e.jsxs("p",{className:"mt-2",children:["Phone: ",s.shipping_address.phone]})]})]}),e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("p",{className:"text-chocolate-600 mb-4",children:"Need help with your order?"}),e.jsx(g,{to:"/contact",className:"inline-block text-ochre hover:text-ochre-600 font-semibold",children:"Contact Support â†’"})]})]})]})};export{U as default};
